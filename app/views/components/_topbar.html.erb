<% cache("topbar", expires_in: 1.year) do %>
  <div class="topbar">
    <!-- Logo principal -->
    <%= link_to root_path, class: "logo" do %>
      <%= image_tag "https://gm-general.s3.amazonaws.com/GM/logo_gm.svg", alt: "Logo GM", loading: "lazy" %>
    <% end %>

    <!-- Formulario de búsqueda -->
    <%= form_for :article, url: { controller: "titlepage", action: 'search_article' }, method: :get, html: { role: "search" } do |f| %>
      <%= f.autocomplete_field :articable_id, search_autocomplete_path, id_element: '#article_articable_id', placeholder: "Busca tu nota", autocomplete: "off", class: "search-field" %>
    <% end %>

    <!-- Selector de ubicación (solo si está activo) -->
    <%= render("components/change-location") if defined?(ChangeLocationComponent) %>

    <!-- Redes sociales -->
    <div class="social-icons">
      <% {
        facebook: "FACEBOOK.svg",
        twitter: "TWITTER.svg",
        instagram: "INSTAGRAM.svg",
        tiktok: "TIKTOK.svg"
      }.each do |name, icon| %>
        <%= link_to "#", target: "_blank", rel: "noopener", class: "social-link #{name}" do %>
          <%= image_tag "https://gm-general.s3.amazonaws.com/GM/#{icon}", alt: name.to_s.titleize, loading: "lazy" %>
        <% end %>
      <% end %>
    </div>

    <!-- Banner fijo oculto si no hay uno definido -->
    <% if defined?(FixedBannerComponent) && FixedBannerComponent.any? %>
      <%= render("components/fixed-banner") %>
    <% end %>
  </div>
<% end %>
